<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ninebot ES Controller</title>
  <link rel="stylesheet" href="style.css">
  <script src="script.js" defer></script>
</head>
<body>
  <div class="container">
    <!-- –®–∞–ø–∫–∞ -->
    <div class="header">
      <h1>üöÄ Ninebot ES Controller</h1>
      <p>–ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∞—à–µ–≥–æ —Å–∞–º–æ–∫–∞—Ç–∞</p>
    </div>

    <!-- –¢–∞–±—ã –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏ -->
    <div class="tab-container">
      <div class="tab-buttons">
        <button class="tab-button active" onclick="switchTab('main')">–û—Å–Ω–æ–≤–Ω–æ–µ</button>
        <button class="tab-button" onclick="switchTab('extended')">–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
        <button class="tab-button" onclick="switchTab('stats')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        <button class="tab-button" onclick="switchTab('lights')">–ü–æ–¥—Å–≤–µ—Ç–∫–∞</button>
        <button class="tab-button" onclick="switchTab('settings')">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        <button class="tab-button" onclick="switchTab('system')">–°–∏—Å—Ç–µ–º–∞</button>
        <button class="tab-button" onclick="switchTab('research')">–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ</button>
        <button class="tab-button" onclick="switchTab('ota')">üîÑ OTA –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ</button>
      </div>

      <!-- –û—Å–Ω–æ–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ -->
      <div id="main-tab" class="tab-content active">
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="dashboard">
          <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ -->
          <div class="card status-card" id="statusCard">
            <div class="status-icon">üîí</div>
            <div class="status-text" id="statusText">–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù</div>
            <div class="status-subtext" id="statusSubtext">–°–∞–º–æ–∫–∞—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</div>
            
            <div class="data-grid">
              <div class="data-item">
                <div class="data-value" id="batteryValue">0%</div>
                <div class="data-label">–ë–∞—Ç–∞—Ä–µ—è</div>
              </div>
              <div class="data-item">
                <div class="data-value" id="speedValue">0</div>
                <div class="data-label">–∫–º/—á</div>
              </div>
              <div class="data-item">
                <div class="data-value" id="tempValue">0¬∞</div>
                <div class="data-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</div>
              </div>
              <div class="data-item">
                <div class="data-value" id="mileageValue">0</div>
                <div class="data-label">–∫–º</div>
              </div>
            </div>
          </div>

          <!-- –ë—ã—Å—Ç—Ä–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
          <div class="card">
            <h3>‚ö° –ë—ã—Å—Ç—Ä–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
            <div class="button-grid" style="margin-top: 20px;">
              <button class="btn btn-success" onclick="sendCommand('unlock')">
                <span>üîì</span> –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
              </button>
              <button class="btn btn-danger" onclick="sendCommand('lock')">
                <span>üîí</span> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
              </button>
              <button class="btn btn-primary" onclick="sendCommand('open_deck')">
                <span>üîì</span> –û—Ç–∫—Ä—ã—Ç—å –î–µ–∫—É
              </button>
              <button class="btn btn-warning" onclick="sendCommand('toggle_limit')">
                <span>üìè</span> –õ–∏–º–∏—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
              </button>
              <button class="btn btn-primary" onclick="toggleDataRefresh()" id="refreshBtn">
                <span>üîÑ</span> –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
              </button>
            </div>
          </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞–º–∏ -->
        <div class="control-section">
          <div class="section-title">üéõÔ∏è –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã</div>
          <div class="button-grid">
            <button class="btn btn-info" onclick="sendCommand('mode_normal')">
              <span>üö∂</span> NORMAL
            </button>
            <button class="btn btn-info" onclick="sendCommand('mode_eco')">
              <span>üåø</span> ECO
            </button>
            <button class="btn btn-info" onclick="sendCommand('mode_sport')">
              <span>üèéÔ∏è</span> SPORT
            </button>
          </div>
        </div>

        <!-- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ -->
        <div class="control-section">
          <div class="section-title">üìè –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏</div>
          <div class="button-grid">
            <button class="btn btn-warning" onclick="setSpeedLimit(150)">15 –∫–º/—á</button>
            <button class="btn btn-warning" onclick="setSpeedLimit(200)">20 –∫–º/—á</button>
            <button class="btn btn-warning" onclick="setSpeedLimit(250)">25 –∫–º/—á</button>
            <button class="btn btn-warning" onclick="setSpeedLimit(300)">30 –∫–º/—á</button>
            <button class="btn btn-warning" onclick="setSpeedLimit(350)">35 –∫–º/—á</button>
          </div>
        </div>

        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
        <div class="control-section">
          <div class="section-title">üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</div>
          <div class="button-grid">
            <button class="btn btn-toggle" onclick="sendCommand('headlight_toggle')" id="headlightBtn">
              <span>üí°</span> –§–∞—Ä—ã –í–ö–õ
            </button>
            <button class="btn btn-toggle" onclick="sendCommand('beep_toggle')" id="beepBtn">
              <span>üîä</span> –ó–≤—É–∫ –í–ö–õ
            </button>
            <button class="btn btn-toggle" onclick="sendCommand('cruise_toggle')" id="cruiseBtn">
              <span>‚è±Ô∏è</span> –ö—Ä—É–∏–∑ –û–¢–ö–õ
            </button>
            <button class="btn btn-toggle" onclick="sendCommand('engine_on')" id="engineBtn">
              <span>‚ö°</span> –î–≤–∏–≥–∞—Ç–µ–ª—å –í–ö–õ
            </button>
          </div>
        </div>
      </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è -->
      <div id="research-tab" class="tab-content">
        <div class="dashboard">
          <!-- –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ -->
          <div class="card">
            <h3>üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤</h3>
            <p style="margin-bottom: 20px; color: #666;">
              –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ —Å–∞–º–æ–∫–∞—Ç–∞
            </p>

            <div class="scan-controls">
              <button class="scan-btn safe" onclick="startSafeScan()">
                üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (—á—Ç–µ–Ω–∏–µ)
              </button>
              <button class="scan-btn warning" onclick="startBruteForceScan()">
                ‚ö†Ô∏è –ë—Ä—É—Ç—Ñ–æ—Ä—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–∞–ø–∏—Å—å)
              </button>
              <button class="scan-btn danger" onclick="startDeepScan()">
                üö® –ì–ª—É–±–æ–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
              </button>
            </div>

            <div class="scan-progress">
              <div class="scan-progress-bar" id="scanProgress" style="width: 0%"></div>
            </div>

            <div style="text-align: center; margin: 10px 0;">
              <span id="scanStatus">–ì–æ—Ç–æ–≤ –∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é</span>
              <span id="scanProgressText">0/256</span>
            </div>

            <div class="manual-test">
              <input type="text" id="manualIndex" placeholder="–ò–Ω–¥–µ–∫—Å (hex, –Ω–∞–ø—Ä–∏–º–µ—Ä: 0x70)" style="font-family: monospace">
              <input type="text" id="manualValue" placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ (hex, –Ω–∞–ø—Ä–∏–º–µ—Ä: 0x0001)" style="font-family: monospace">
              <button class="btn btn-primary" onclick="manualTest()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>

            <div class="scan-results" id="scanResults">
              <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
          </div>

          <!-- –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã -->
          <div class="card">
            <h3>üéØ –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã</h3>
            <div id="foundRegisters" style="max-height: 300px; overflow-y: auto;">
              <p style="color: #666; text-align: center; padding: 20px;">
                –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
              </p>
            </div>
          </div>

          <!-- –õ–æ–≥ –ø–∞–∫–µ—Ç–æ–≤ -->
          <div class="card">
            <h3>üìã –õ–æ–≥ –ø–∞–∫–µ—Ç–æ–≤</h3>
            <div style="margin-bottom: 15px;">
              <button class="btn btn-primary" onclick="startPacketLog()">–ù–∞—á–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
              <button class="btn btn-danger" onclick="stopPacketLog()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
              <button class="btn" onclick="clearPacketLog()" style="background: #636e72; color: white;">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
            <div id="packetLog" style="max-height: 200px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 0.8rem;">
            </div>
          </div>
          <!-- –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã -->
          <div class="card">
            <h3>üìã –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã</h3>
            <div style="margin-top: 15px;">
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x51, –ö—É—Ä–æ–∫ –≥–∞–∑–∞:</strong> <span id="UnkReg18">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x52, –¢–æ—Ä–º–æ–∑:</strong> <span id="UnkReg19">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x2C(–ö–∞–∫ 56):</strong> <span id="UnkReg8">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x4C(–Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è):</strong> <span id="UnkReg15">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x54(–ö–∞–∫ 56):</strong> <span id="UnkReg20">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x56(–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è1-5):</strong> <span id="UnkReg21">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x57–Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è:</strong> <span id="UnkReg22">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x66(–Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è):</strong> <span id="UnkReg26">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x7F(–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å, –æ—à–∏–±–∫–∞ 32):</strong> <span id="UnkReg28">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x80(–§–∞—Ä–∞:0 - –í—ã–∫–ª,1 - –í–∫–ª, 2 - –°—Ç—Ä–æ–±, –¥–∏—Å–ø–ª–µ–π –≤—ã–∫–ª):</strong> <span id="UnkReg30">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x0:</strong> <span id="UnkReg1">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x1:</strong> <span id="UnkReg2">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0xD:</strong> <span id="UnkReg3">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0xE:</strong> <span id="UnkReg4">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0xF:</strong> <span id="UnkReg5">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x23:</strong> <span id="UnkReg6">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x27:</strong> <span id="UnkReg7">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x2D:</strong> <span id="UnkReg9">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x2E:</strong> <span id="UnkReg10">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x48:</strong> <span id="UnkReg11">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x49:</strong> <span id="UnkReg12">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x4A:</strong> <span id="UnkReg13">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x4B:</strong> <span id="UnkReg14">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x4D:</strong> <span id="UnkReg16">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x4E:</strong> <span id="UnkReg17">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x60:</strong> <span id="UnkReg23">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x61:</strong> <span id="UnkReg24">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x64:</strong> <span id="UnkReg25">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x67:</strong> <span id="UnkReg27">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x7F:</strong> <span id="UnkReg29">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x84:</strong> <span id="UnkReg31">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x8C:</strong> <span id="UnkReg32">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x8D:</strong> <span id="UnkReg33">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x8F:</strong> <span id="UnkReg34">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x9B:</strong> <span id="UnkReg35">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0x9F:</strong> <span id="UnkReg36">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0xC4:</strong> <span id="UnkReg37">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0xC5:</strong> <span id="UnkReg38">N/A</span></p>
              <p><strong>–†–µ–≥–∏—Å—Ç—Ä 0xCF:</strong> <span id="UnkReg39">N/A</span></p>
            </div>
            <div id="packetLog" style="max-height: 200px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 0.8rem;">
            </div>
          </div>
        </div>
      </div>

      <!-- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
      <div id="extended-tab" class="tab-content">
        <div class="dashboard">
          <!-- –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
          <div class="card">
            <h3>üîß –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div class="extended-grid">
              <div class="info-item">
                <div class="info-value" id="driveVoltageValue">0.0</div>
                <div class="info-label">–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ (–í)</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="motorCurrentValue">0.0</div>
                <div class="info-label">–¢–æ–∫ (–ê)</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="powerValue">0</div>
                <div class="info-label">–ú–æ—â–Ω–æ—Å—Ç—å (–í—Ç)</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="avgSpeedValue">0</div>
                <div class="info-label">–°—Ä. —Å–∫–æ—Ä–æ—Å—Ç—å</div>
              </div>
            </div>
          </div>

          <!-- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã -->
          <div class="card">
            <h3>üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</h3>
            <div class="extended-grid">
              <div class="info-item">
                <div class="info-value" id="bodyTempValue">0¬∞</div>
                <div class="info-label">–ö–æ—Ä–ø—É—Å</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="bat1TempValue">0¬∞</div>
                <div class="info-label">–ë–∞—Ç–∞—Ä–µ—è 1</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="bat2TempValue">0¬∞</div>
                <div class="info-label">–ë–∞—Ç–∞—Ä–µ—è 2</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="mosTempValue">0¬∞</div>
                <div class="info-label">MOS</div>
              </div>
            </div>
          </div>

          <!-- –ë–∞—Ç–∞—Ä–µ–∏ -->
          <div class="card">
            <h3>üîã –ë–∞—Ç–∞—Ä–µ–∏</h3>
            <div class="extended-grid">
              <div class="info-item">
                <div class="info-value" id="battery1Value">0%</div>
                <div class="info-label">–ë–∞—Ç–∞—Ä–µ—è 1</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="battery2Value">0%</div>
                <div class="info-label">–ë–∞—Ç–∞—Ä–µ—è 2</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="actualRangeValue">0</div>
                <div class="info-label">–ó–∞–ø–∞—Å —Ö–æ–¥–∞ (–∫–º)</div>
              </div>
              <div class="info-item">
                <div class="info-value" id="predictedRangeValue">0</div>
                <div class="info-label">–ü—Ä–æ–≥–Ω–æ–∑ (–∫–º)</div>
              </div>
            </div>
          </div>

          <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
          <div class="card">
            <h3>üìä –°–∏—Å—Ç–µ–º–∞</h3>
            <div style="margin-top: 15px;">
              <p><strong>–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä:</strong> <span id="serialValue">N/A</span></p>
              <p><strong>BMS –≤–µ—Ä—Å–∏—è:</strong> <span id="bmsVersionValue">N/A</span></p>
              <p><strong>–í–Ω–µ—à–Ω—è—è BMS:</strong> <span id="bms2VersionValue">N/A</span></p>
              <p><strong>BLE –≤–µ—Ä—Å–∏—è:</strong> <span id="bleVersionValue">N/A</span></p>
              <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="boolStatusValue">N/A</span></p>
              <p><strong>–¢—Ä–µ–≤–æ–≥–∏:</strong> <span id="alarmStatusValue">–ù–µ—Ç</span></p>
              <p><strong>–û—à–∏–±–∫–∏:</strong> <span id="errorValue">0</span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
      <div id="stats-tab" class="tab-content">
        <div class="dashboard">
          <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–µ–∑–¥–æ–∫ -->
          <div class="card">
            <h3>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–µ–∑–¥–æ–∫</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value" id="singleMileageValue">0</div>
                <div class="stat-label">–ü—Ä–æ–±–µ–≥ –ø–æ–µ–∑–¥–∫–∏ (–∫–º)</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="singleRideTimeValue">0</div>
                <div class="stat-label">–í—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏ (–º–∏–Ω)</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="totalOperationTimeValue">0</div>
                <div class="stat-label">–û–±—â–µ–µ –≤—Ä–µ–º—è (—á)</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="totalRideTimeValue">0</div>
                <div class="stat-label">–í—Ä–µ–º—è –¥–≤–∏–∂–µ–Ω–∏—è (—á)</div>
              </div>
            </div>
          </div>

          <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
          <div class="card">
            <h3>üìä –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div style="margin-top: 15px;">
              <p><strong>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</strong> <span id="workModeValue">N/A</span></p>
              <p><strong>–õ–∏–º–∏—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏:</strong> <span id="speedLimitValue">0</span> –∫–º/—á</p>
              <p><strong>–ö–æ–¥ –æ—à–∏–±–∫–∏:</strong> <span id="errorCodeValue">0</span></p>
              <p><strong>–ö—Ä—É–∏–∑-–∫–æ–Ω—Ç—Ä–æ–ª—å:</strong> <span id="cruiseValue">–í–´–ö–õ</span></p>
              <p><strong>–§–∞—Ä—ã:</strong> <span id="headlightValue">–í–ö–õ</span></p>
              <p><strong>–ó–≤—É–∫:</strong> <span id="beepValue">–í–ö–õ</span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ -->
      <div id="lights-tab" class="tab-content">
        <div class="dashboard">
          <!-- –†–µ–∂–∏–º—ã –ø–æ–¥—Å–≤–µ—Ç–∫–∏ -->
          <div class="card">
            <h3>üåà –†–µ–∂–∏–º—ã –ø–æ–¥—Å–≤–µ—Ç–∫–∏</h3>
            <div class="led-mode-grid">
              <div class="led-mode-btn" onclick="setLedMode(0)" id="ledMode0">–í—ã–∫–ª—é—á–µ–Ω–æ</div>
              <div class="led-mode-btn" onclick="setLedMode(1)" id="ledMode1">–û–¥–Ω–æ—Ü–≤–µ—Ç–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ</div>
              <div class="led-mode-btn" onclick="setLedMode(2)" id="ledMode2">–í—Å–µ—Ü–≤–µ—Ç–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ</div>
              <div class="led-mode-btn" onclick="setLedMode(3)" id="ledMode3">–î–≤–∞ —Ü–≤–µ—Ç–∞ —Ä–∞–∑–¥–µ–ª—å–Ω–æ</div>
              <div class="led-mode-btn" onclick="setLedMode(4)" id="ledMode4">–í—Å–µ —Ü–≤–µ—Ç–∞ —Ä–∞–∑–¥–µ–ª—å–Ω–æ</div>
              <div class="led-mode-btn" onclick="setLedMode(5)" id="ledMode5">–û–¥–Ω–æ—Ü–≤–µ—Ç–Ω–æ–µ –º–µ—Ä—Ü–∞–Ω–∏–µ</div>
              <div class="led-mode-btn" onclick="setLedMode(6)" id="ledMode6">–í—Å–µ—Ü–≤–µ—Ç–Ω–æ–µ –º–µ—Ä—Ü–∞–Ω–∏–µ</div>
              <div class="led-mode-btn" onclick="setLedMode(7)" id="ledMode7">–ü–æ–ª–∏—Ü–∏—è 1</div>
              <div class="led-mode-btn" onclick="setLedMode(8)" id="ledMode8">–ü–æ–ª–∏—Ü–∏—è 2</div>
              <div class="led-mode-btn" onclick="setLedMode(9)" id="ledMode9">–ü–æ–ª–∏—Ü–∏—è 3</div>
            </div>
          </div>

          <!-- –¶–≤–µ—Ç–∞ –ø–æ–¥—Å–≤–µ—Ç–∫–∏ -->
          <div class="card">
            <h3>üé® –¶–≤–µ—Ç–∞ –ø–æ–¥—Å–≤–µ—Ç–∫–∏</h3>
            <div style="margin: 20px 0;">
              <h4>–¶–≤–µ—Ç 1 (–û—Å–Ω–æ–≤–Ω–æ–π)</h4>
              <div class="color-picker">
                <div class="color-option" style="background: rgb(0, 0, 255);" onclick="setLedColor(1, 0xA0F0)" title="–°–∏–Ω–∏–π"></div>
                <div class="color-option" style="background: rgb(0, 255, 0);" onclick="setLedColor(1, 0x50F0)" title="–ó–µ–ª–µ–Ω—ã–π"></div>
                <div class="color-option" style="background: rgb(255, 0, 0);" onclick="setLedColor(1, 0x00F0)" title="–ö—Ä–∞—Å–Ω—ã–π"></div>
                <div class="color-option" style="background: rgb(255, 0, 255);" onclick="setLedColor(1, 0xC8F0)" title="–§–∏–æ–ª–µ—Ç–æ–≤—ã–π"></div>
                <div class="color-option" style="background: rgb(255, 255, 255);" onclick="setLedColor(1, 0xF0F0)" title="–ë–µ–ª—ã–π"></div>
                <div class="color-option" style="background: rgb(255, 255, 0);" onclick="setLedColor(1, 0xFFF0)" title="–ñ–µ–ª—Ç—ã–π"></div>
              </div>
            </div>
            
            <div style="margin: 20px 0;">
              <h4>–¶–≤–µ—Ç 2 (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π)</h4>
              <div class="color-picker">
                <div class="color-option" style="background: rgb(0, 0, 255);" onclick="setLedColor(2, 0xA0F0)" title="–°–∏–Ω–∏–π"></div>
                <div class="color-option" style="background: rgb(0, 255, 0);" onclick="setLedColor(2, 0x50F0)" title="–ó–µ–ª–µ–Ω—ã–π"></div>
                <div class="color-option" style="background: rgb(255, 0, 0);" onclick="setLedColor(2, 0x00F0)" title="–ö—Ä–∞—Å–Ω—ã–π"></div>
                <div class="color-option" style="background: rgb(255, 0, 255);" onclick="setLedColor(2, 0xC8F0)" title="–§–∏–æ–ª–µ—Ç–æ–≤—ã–π"></div>
                <div class="color-option" style="background: rgb(255, 255, 255);" onclick="setLedColor(2, 0xF0F0)" title="–ë–µ–ª—ã–π"></div>
                <div class="color-option" style="background: rgb(255, 255, 0);" onclick="setLedColor(2, 0xFFF0)" title="–ñ–µ–ª—Ç—ã–π"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
      <div id="settings-tab" class="tab-content">
        <div class="dashboard">
          <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π -->
          <div class="card">
            <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π</h3>
            <div style="margin-top: 20px;">
              <div class="setting-row">
                <span class="setting-label">–§–∞—Ä—ã –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω—ã</span>
                <label class="switch">
                  <input type="checkbox" id="headlightAlwaysOn" onchange="toggleSetting('headlight_always_on', this.checked)">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-row">
                <span class="setting-label">–°–∫–æ—Ä–æ—Å—Ç—å –≤ MPH (–≤–º–µ—Å—Ç–æ KM/H)</span>
                <label class="switch">
                  <input type="checkbox" id="speedInMPH" onchange="toggleSetting('speed_mph', this.checked)">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-row">
                <span class="setting-label">–û—Ç–∫–ª—é—á–∏—Ç—å —Ç—Ä–µ–≤–æ–≥—É –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ</span>
                <label class="switch">
                  <input type="checkbox" id="noAlarmLock" onchange="toggleSetting('no_alarm_lock', this.checked)">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-row">
                <span class="setting-label">Bluetooth broadcast</span>
                <label class="switch">
                  <input type="checkbox" id="btBroadcast" onchange="toggleSetting('bt_broadcast', this.checked)">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-row">
                <span class="setting-label">–ö–Ω–æ–ø–∫–∞ —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏</span>
                <label class="switch">
                  <input type="checkbox" id="buttonSpeedMode" checked onchange="toggleSetting('button_speed_mode', this.checked)">
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </div>

          <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–≤—É–∫–∞ –∏ —Å–≤–µ—Ç–∞ -->
          <div class="card">
            <h3>üîä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–≤—É–∫–∞ –∏ —Å–≤–µ—Ç–∞</h3>
            <div style="margin-top: 20px;">
              <div class="setting-row">
                <span class="setting-label">–ó–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª</span>
                <label class="switch">
                  <input type="checkbox" id="beepAlarm" checked onchange="toggleBeepAlarm(this.checked)">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-row">
                <span class="setting-label">–û–±—â–∏–π –∑–≤—É–∫</span>
                <label class="switch">
                  <input type="checkbox" id="beepTotal" checked onchange="toggleBeepTotal(this.checked)">
                  <span class="slider"></span>
                </label>
              </div>
              
              <div class="setting-row">
                <span class="setting-label">–§–∞—Ä—ã</span>
                <label class="switch">
                  <input type="checkbox" id="headlight" checked onchange="toggleHeadlight(this.checked)">
                  <span class="slider"></span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

            <!-- OTA –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ -->
      <div id="ota-tab" class="tab-content">
        <div class="dashboard">
          <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
          <div class="card">
            <h3>üíª –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ</h3>
            <div id="systemInfo" style="margin-top: 15px;">
              <p><strong>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</strong></p>
            </div>
            <button class="btn btn-primary" onclick="loadSystemInfo()" style="margin-top: 10px;">
              üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            </button>
          </div>

          <!-- OTA –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
          <div class="card">
            <h3>üöÄ OTA –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—à–∏–≤–∫–∏</h3>
            <div style="margin: 20px 0;">
              <p><strong>–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:</strong> <span id="currentVersion">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
              <p><strong>–°–≤–æ–±–æ–¥–Ω–∞—è –ø–∞–º—è—Ç—å:</strong> <span id="freeMemory">-</span></p>
              <p><strong>ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</strong> <span id="deviceId">-</span></p>
            </div>

            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
              <h4>üì§ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π OTA –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</h4>
              <p style="margin-bottom: 15px;">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ESP8266 –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</p>
              
              <div class="button-grid">
                <a href="/update" target="_blank" class="btn btn-success" style="text-decoration: none;">
                  üì§ –û—Ç–∫—Ä—ã—Ç—å OTA –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                </a>
                <button class="btn btn-info" onclick="checkForUpdates()">
                  üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                </button>
              </div>
              
              <div style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                <p><strong>–õ–æ–≥–∏–Ω:</strong> admin</p>
                <p><strong>–ü–∞—Ä–æ–ª—å:</strong> NinebotOTA123!</p>
              </div>
            </div>

            <!-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É -->
            <div style="margin-top: 20px;">
              <h4>üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞</h4>
              <form id="otaForm" action="/update" method="POST" enctype="multipart/form-data" target="_blank">
                <div style="margin: 15px 0;">
                  <label style="display: block; margin-bottom: 10px; font-weight: bold;">
                    üì§ –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –ø—Ä–æ—à–∏–≤–∫–∏ (.bin):
                  </label>
                  <input type="file" name="update" accept=".bin" required 
                        style="width: 100%; padding: 10px; border: 2px dashed #ddd; border-radius: 8px;">
                </div>
                
                <button type="submit" class="btn btn-warning">
                  ‚ö° –ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É
                </button>
              </form>
            </div>
          </div>

          <!-- –°—Ç–∞—Ç—É—Å OTA -->
          <div class="card">
            <h3>üìä –°—Ç–∞—Ç—É—Å OTA</h3>
            <div id="otaStatus" style="margin-top: 15px;">
              <p><strong>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> <span id="lastUpdate">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span></p>
              <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="updateStatus">–ì–æ—Ç–æ–≤ –∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é</span></p>
            </div>
            
            <div class="button-grid" style="margin-top: 15px;">
              <button class="btn btn-info" onclick="testOTAConnection()">
                üß™ –¢–µ—Å—Ç OTA —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
              </button>
              <button class="btn btn-danger" onclick="showOTAInstructions()">
                üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- –°–∏—Å—Ç–µ–º–∞ -->
      <div id="system-tab" class="tab-content">
        <div class="dashboard">
          <!-- –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã -->
          <div class="card">
            <h3>üõ†Ô∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã</h3>
            <div class="button-grid" style="margin-top: 20px;">
              <button class="btn btn-warning" onclick="sendCommand('find_scooter')">
                <span>üîç</span> –ù–∞–π—Ç–∏ —Å–∞–º–æ–∫–∞—Ç
              </button>
              <button class="btn btn-info" onclick="sendCommand('reboot')">
                <span>üîÑ</span> –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
              </button>
              <button class="btn btn-danger" onclick="sendCommand('power_off')">
                <span>‚≠ï</span> –í—ã–∫–ª—é—á–∏—Ç—å
              </button>
            </div>
          </div>

          <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
          <div class="card">
            <h3>üíª –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div style="margin-top: 15px;">
              <p><strong>–¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º –ø–æ–¥—Å–≤–µ—Ç–∫–∏:</strong> <span id="currentLedMode">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span></p>
              <p><strong>–í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞:</strong> <span id="fwVersion">N/A</span></p>
              <p><strong>–†–∞–±–æ—á–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> <span id="workSystem">1</span></p>
              <p><strong>–°—Ç–∞—Ç—É—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:</strong> <span id="lockStatus">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span></p>
              <p><strong>–°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∏–≥–∞—Ç–µ–ª—è:</strong> <span id="engineStatus">–í–ö–õ</span></p>
            </div>
          </div>

          <!-- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ -->
          <div class="card">
            <h3>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h3>
            <div style="margin-top: 15px;">
              <p><strong>–ö–æ–¥ –æ—à–∏–±–∫–∏:</strong> <span id="diagnosticError">0</span></p>
              <p><strong>–ö–æ–¥ —Ç—Ä–µ–≤–æ–≥–∏:</strong> <span id="diagnosticAlarm">0</span></p>
              <p><strong>–ë—É–ª–µ–≤—ã —Å—Ç–∞—Ç—É—Å—ã:</strong> <span id="diagnosticBool">0x0000</span></p>
              <p><strong>–ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞—Ç—É—Å—ã:</strong> <span id="diagnosticQuickBool">0x0000</span></p>
              <button class="btn btn-primary" onclick="loadDiagnostics()" style="margin-top: 10px;">
                –û–±–Ω–æ–≤–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
  <div class="notification" id="notification"></div>

</body>
</html>