<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent" />
    <title>Ninebot ES Controller</title>
    <link rel="stylesheet" href="style.css">
  </head>

  <body>
    <!-- –ú–æ–±–∏–ª—å–Ω—ã–π —Ö–µ–¥–µ—Ä -->
    <div class="mobile-header">
      <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
      <div class="mobile-title" id="mobileTitle">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</div>
      <div class="mobile-actions">
        <button
          class="btn btn-outline"
          style="padding: 8px; min-height: 40px; min-width: 40px"
          onclick="toggleDataRefresh()">
          üóò
        </button>
        <div class="battery-with-icon">
          <div class="material-battery" id="materialBattery" data-theme="green">
            <div class="material-battery-shape">
              <div class="material-battery-fill" id="materialBatteryFill"></div>
            </div>
            <span class="material-battery-percent" id="materialBatteryPercent"
              >?</span
            >
          </div>
        </div>
      </div>
    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π –¥–ª—è –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ -->
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <div class="sidebar">
      <div class="logo" style="margin-bottom: 30px">
        <div class="logo-icon">üõ¥</div>
        <div class="logo-text">
          <h1>Ninebot ES</h1>
          <p>–ú–æ–±–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä</p>
        </div>
      </div>

      <nav class="nav-menu scrollable">
        <button class="nav-item active" onclick="switchTab('dashboard')">
          <span class="icon">üìä</span>
          <span>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</span>
        </button>
        <button class="nav-item" onclick="switchTab('extended')">
          <span class="icon">üîç</span>
          <span>–î–µ—Ç–∞–ª–∏</span>
        </button>
        <button class="nav-item" onclick="switchTab('lights')">
          <span class="icon">üåà</span>
          <span>–ü–æ–¥—Å–≤–µ—Ç–∫–∞</span>
        </button>
        <button class="nav-item" onclick="switchTab('stats')">
          <span class="icon">üìà</span>
          <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
        </button>
        <button class="nav-item" onclick="switchTab('settings')">
          <span class="icon">‚öôÔ∏è</span>
          <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
        </button>
        <button class="nav-item" onclick="switchTab('research')">
          <span class="icon">üî¨</span>
          <span>–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ</span>
        </button>
        <button class="nav-item" onclick="switchTab('system')">
          <span class="icon">üíª</span>
          <span>–°–∏—Å—Ç–µ–º–∞</span>
        </button>
        <button class="nav-item" onclick="switchTab('ota')">
          <span class="icon">üîÑ</span>
          <span>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
        </button>
      </nav>

      <div class="status-bar">
        <div class="status-indicator">
          <div class="status-dot" id="connectionStatus"></div>
          <div id="connectionText">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <div
          style="
            font-size: 0.85rem;
            opacity: 0.8;
            text-align: center;
            margin-top: 10px;
          ">
          <div>–ë–∞—Ç–∞—Ä–µ—è: <span id="sidebarBattery">0%</span></div>
          <div id="sidebarSpeed">–°–∫–æ—Ä–æ—Å—Ç—å: 0 –∫–º/—á</div>
        </div>
      </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
    <div class="main-content scrollable">
      <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
      <div id="dashboard-tab" class="tab-content active">
        <!-- –°–≤–∞–π–ø-–∫–æ–Ω—Ç—Ä–æ–ª—å –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ -->
        <div class="swipe-control animate-slide" id="swipeControl">
          <div
            class="grid-5 top-bar">
            <div style="text-align: center">
              <div class="value-display" id="batteryValue">
                0<span class="value-unit">%</span>
              </div>
              <div style="font-size: 0.85rem; color: white; margin-top: 4px">
                –ë–∞—Ç–∞—Ä–µ—è
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="actualRangeValue">
                0<span class="value-unit">–∫–º</span>
              </div>
              <div style="font-size: 0.85rem; color: white; margin-top: 4px">
                –ó–∞–ø–∞—Å —Ö–æ–¥–∞
              </div>
            </div>
            <!-- <div style="text-align: center">
              <div class="value-display" id="speedValue">
                0<span class="value-unit">–∫–º/—á</span>
              </div>
              <div style="font-size: 0.85rem; color: white; margin-top: 4px">
                –°–∫–æ—Ä–æ—Å—Ç—å
              </div>
            </div> -->
            <div style="text-align: center">
              <div class="value-display" id="tempValue">
                0<span class="value-unit">¬∞C</span>
              </div>
              <div style="font-size: 0.85rem; color: white; margin-top: 4px">
                –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
              </div>
            </div>
          </div>
          <img
            src="head.png"
            alt="–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
            style="max-width: 100%" />
          <div
            style="
              text-align: center;
              margin-top: 16px;
              font-size: 0.9rem;
              color: white;
            ">
            <span id="statusText">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
          </div>
          <div class="swipe-track">
            <div class="swipe-progress" id="swipeProgress"></div>
            <div
              class="swipe-handle"
              id="swipeHandle">
              ‚ûú
            </div>
          </div>
          <div
            style="font-size: 0.85rem; opacity: 0.9; margin-top: 12px"
            id="swipeInstruction">
            –ü–æ—Ç—è–Ω–∏—Ç–µ –≤–ø—Ä–∞–≤–æ —á—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
          </div>
        </div>

        <button
          class="btn btn-outline"
          onclick="sendCommand('open_deck')"
          style="
            padding: 13px;
            width: 100%;
            display: flex;
            align-items: center;
            gap: 12px;
            border-radius: 16px;
            margin-bottom: 12px;
            background: var(--card-bg);
            border: 1px solid var(--gray);
            color: var(--secondary);
            font-weight: 600;
          ">
          <span style="font-size: 20px">üì¶</span>
          <span style="font-size: 0.75rem">–û—Ç–∫—Ä—ã—Ç—å –¥–µ–∫—É</span>
        </button>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <div class="card animate-slide">
          <div
            style="
              font-weight: 600;
              margin-bottom: 16px;
              display: flex;
              align-items: center;
              gap: 8px;
            ">
            <span>‚ö°</span> –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
          </div>
          <div class="grid-3">
            <button
              class="btn btn-outline"
              onclick="sendCommand('find_scooter')"
              style="flex-direction: column; padding: 12px">
              <span style="font-size: 20px">üîç</span>
              <span style="font-size: 0.75rem">–ù–∞–π—Ç–∏</span>
            </button>
            <button
              class="btn btn-outline"
              onclick="showActionSheet('power')"
              style="flex-direction: column; padding: 12px">
              <span style="font-size: 20px">üîã</span>
              <span style="font-size: 0.75rem">–ü–∏—Ç–∞–Ω–∏–µ</span>
            </button>
            <button
              class="btn btn-outline"
              onclick="toggleDataRefresh()"
              style="flex-direction: column; padding: 12px">
              <span style="font-size: 20px">üîÑ</span>
              <span style="font-size: 0.75rem">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
            </button>
            <button
              class="btn btn-outline"
              onclick="sendCommand('toggle_limit')"
              style="flex-direction: column; padding: 12px">
              <span style="font-size: 20px">üìè</span>
              <span style="font-size: 0.75rem">–õ–∏–º–∏—Ç</span>
            </button>
            <button
              class="btn btn-outline"
              onclick="toggleCruise()"
              style="flex-direction: column; padding: 12px"
              id="cruiseBtn">
              <span style="font-size: 20px">‚è±Ô∏è</span>
              <span style="font-size: 0.75rem">–ö—Ä—É–∏–∑</span>
            </button>
          </div>
        </div>

        <!-- –†–µ–∂–∏–º—ã —Å–∫–æ—Ä–æ—Å—Ç–∏ -->
        <div class="card animate-slide">
          <div
            style="
              font-weight: 600;
              margin-bottom: 16px;
              display: flex;
              align-items: center;
              gap: 8px;
            ">
            <span>üéÆ</span> –†–µ–∂–∏–º —Å–∫–æ—Ä–æ—Å—Ç–∏
          </div>
          <div class="grid-5">
            <button
              class="btn btn-outline"
              onclick="sendCommand('mode_eco')"
              id="modeEcoBtn"
              style="padding: 12px">
              –≠–∫–æ
            </button>
            <button
              class="btn btn-outline"
              onclick="sendCommand('mode_normal')"
              id="modeNormalBtn"
              style="padding: 12px">
              –°—Ç–∞–Ω–¥–∞—Ä—Ç
            </button>
            <button
              class="btn btn-outline active"
              onclick="sendCommand('mode_sport')"
              id="modeSportBtn"
              style="padding: 12px">
              –°–ø–æ—Ä—Ç
            </button>
          </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ -->
        <div class="card animate-slide">
          <div
            style="
              font-weight: 600;
              margin-bottom: 16px;
              display: flex;
              align-items: center;
              gap: 8px;
            ">
            <span>üîß</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
          </div>
          <div class="grid-2">
            <button
              class="btn btn-outline"
              onclick="toggleFunction('headlight')"
              id="headlightBtn"
              style="padding: 14px">
              <span>üí°</span> –§–∞—Ä—ã
            </button>
            <button
              class="btn btn-outline"
              onclick="toggleFunction('beep')"
              id="beepBtn"
              style="padding: 14px">
              <span>üîä</span> –ó–≤—É–∫
            </button>
          </div>
        </div>

        <!-- –õ–∏–º–∏—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ -->
        <div class="card animate-slide">
          <div
            style="
              font-weight: 600;
              margin-bottom: 16px;
              display: flex;
              align-items: center;
              justify-content: space-between;
            ">
            <div style="display: flex; align-items: center; gap: 8px">
              <span>üìè</span> –õ–∏–º–∏—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏
            </div>
            <div
              style="font-size: 1.2rem; font-weight: 700"
              id="speedLimitValue">
              35 –∫–º/—á
            </div>
          </div>
          <div class="slider-container">
            <input
              type="range"
              min="15"
              max="30"
              value="30"
              step="5"
              class="speed-slider"
              id="speedSlider"
              oninput="updateSpeedLimit(this.value)" />
            <div
              style="
                display: flex;
                justify-content: space-between;
                font-size: 0.85rem;
                color: var(--secondary);
              ">
              <span>15</span>
              <span>20</span>
              <span>25</span>
              <span>30</span>
            </div>
          </div>
        </div>
      </div>

      <!-- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
      <div id="extended-tab" class="tab-content">
        <!-- –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üîß –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
          <div class="grid-4">
            <div style="text-align: center">
              <div class="value-display" id="driveVoltageValue">
                0.0<span style="font-size: 0.8rem">V</span>
              </div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="motorCurrentValue">
                0.0<span style="font-size: 0.8rem">A</span>
              </div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –¢–æ–∫
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="powerValue">
                0<span style="font-size: 0.8rem">W</span>
              </div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ú–æ—â–Ω–æ—Å—Ç—å
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="avgSpeedValue">
                0<span style="font-size: 0.8rem">–∫–º/—á</span>
              </div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –°—Ä. —Å–∫–æ—Ä–æ—Å—Ç—å
              </div>
            </div>
          </div>
        </div>

        <!-- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã -->
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã</h3>
          <div class="grid-4">
            <div style="text-align: center">
              <div class="value-display" id="bodyTempValue">0¬∞</div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ö–æ—Ä–ø—É—Å
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="bat1TempValue">0¬∞</div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ë–∞—Ç–∞—Ä–µ—è 1
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="bat2TempValue">0¬∞</div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ë–∞—Ç–∞—Ä–µ—è 2
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="mosTempValue">0¬∞</div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                MOS
              </div>
            </div>
          </div>
        </div>

        <!-- –ë–∞—Ç–∞—Ä–µ–∏ -->
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üîã –ë–∞—Ç–∞—Ä–µ–∏</h3>
          <div class="grid-4">
            <div style="text-align: center">
              <div class="value-display" id="battery1Value">0%</div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ë–∞—Ç–∞—Ä–µ—è 1
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="battery2Value">0%</div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ë–∞—Ç–∞—Ä–µ—è 2
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="actualRangeValue">
                0<span style="font-size: 0.8rem">–∫–º</span>
              </div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ó–∞–ø–∞—Å —Ö–æ–¥–∞
              </div>
            </div>
            <div style="text-align: center">
              <div class="value-display" id="predictedRangeValue">
                0<span style="font-size: 0.8rem">–∫–º</span>
              </div>
              <div
                style="
                  font-size: 0.85rem;
                  color: var(--secondary);
                  margin-top: 4px;
                ">
                –ü—Ä–æ–≥–Ω–æ–∑
              </div>
            </div>
          </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üìä –°–∏—Å—Ç–µ–º–∞</h3>
          <div class="grid-2" style="gap: 16px">
            <div>
              <p>
                <strong>–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä:</strong>
                <span id="serialValue">N/A</span>
              </p>
              <p>
                <strong>BMS –≤–µ—Ä—Å–∏—è:</strong>
                <span id="bmsVersionValue">N/A</span>
              </p>
              <p>
                <strong>–í–Ω–µ—à–Ω—è—è BMS:</strong>
                <span id="bms2VersionValue">N/A</span>
              </p>
              <p>
                <strong>BLE –≤–µ—Ä—Å–∏—è:</strong>
                <span id="bleVersionValue">N/A</span>
              </p>
            </div>
            <div>
              <p>
                <strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="boolStatusValue">N/A</span>
              </p>
              <p>
                <strong>–¢—Ä–µ–≤–æ–≥–∏:</strong> <span id="alarmStatusValue">–ù–µ—Ç</span>
              </p>
              <p><strong>–û—à–∏–±–∫–∏:</strong> <span id="errorValue">0</span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ -->
      <div id="lights-tab" class="tab-content">
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üåà –†–µ–∂–∏–º—ã –ø–æ–¥—Å–≤–µ—Ç–∫–∏</h3>
          <div class="led-mode-grid">
            <div class="led-mode-btn" onclick="setLedMode(0)" id="ledMode0">
              –í—ã–∫–ª—é—á–µ–Ω–æ
            </div>
            <div class="led-mode-btn" onclick="setLedMode(1)" id="ledMode1">
              –û–¥–Ω–æ—Ü–≤–µ—Ç–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ
            </div>
            <div class="led-mode-btn" onclick="setLedMode(2)" id="ledMode2">
              –í—Å–µ—Ü–≤–µ—Ç–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ
            </div>
            <div class="led-mode-btn" onclick="setLedMode(3)" id="ledMode3">
              –î–≤–∞ —Ü–≤–µ—Ç–∞ —Ä–∞–∑–¥–µ–ª—å–Ω–æ
            </div>
            <div class="led-mode-btn" onclick="setLedMode(4)" id="ledMode4">
              –í—Å–µ —Ü–≤–µ—Ç–∞ —Ä–∞–∑–¥–µ–ª—å–Ω–æ
            </div>
            <div class="led-mode-btn" onclick="setLedMode(5)" id="ledMode5">
              –û–¥–Ω–æ—Ü–≤–µ—Ç–Ω–æ–µ –º–µ—Ä—Ü–∞–Ω–∏–µ
            </div>
            <div class="led-mode-btn" onclick="setLedMode(6)" id="ledMode6">
              –í—Å–µ—Ü–≤–µ—Ç–Ω–æ–µ –º–µ—Ä—Ü–∞–Ω–∏–µ
            </div>
            <div class="led-mode-btn" onclick="setLedMode(7)" id="ledMode7">
              –ü–æ–ª–∏—Ü–∏—è 1
            </div>
            <div class="led-mode-btn" onclick="setLedMode(8)" id="ledMode8">
              –ü–æ–ª–∏—Ü–∏—è 2
            </div>
            <div class="led-mode-btn" onclick="setLedMode(9)" id="ledMode9">
              –ü–æ–ª–∏—Ü–∏—è 3
            </div>
          </div>
        </div>

        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üé® –¶–≤–µ—Ç–∞ –ø–æ–¥—Å–≤–µ—Ç–∫–∏</h3>
          <div style="margin: 20px 0">
            <h4 style="margin-bottom: 12px">–¶–≤–µ—Ç 1 (–û—Å–Ω–æ–≤–Ω–æ–π)</h4>
            <div class="color-picker">
              <div
                class="color-option"
                style="background: rgb(0, 0, 255)"
                onclick="setLedColor(1, 0xA0F0)"
                title="–°–∏–Ω–∏–π"></div>
              <div
                class="color-option"
                style="background: rgb(0, 255, 0)"
                onclick="setLedColor(1, 0x50F0)"
                title="–ó–µ–ª–µ–Ω—ã–π"></div>
              <div
                class="color-option"
                style="background: rgb(255, 0, 0)"
                onclick="setLedColor(1, 0x00F0)"
                title="–ö—Ä–∞—Å–Ω—ã–π"></div>
              <div
                class="color-option"
                style="background: rgb(255, 0, 255)"
                onclick="setLedColor(1, 0xC8F0)"
                title="–§–∏–æ–ª–µ—Ç–æ–≤—ã–π"></div>
              <div
                class="color-option"
                style="background: rgb(255, 255, 255)"
                onclick="setLedColor(1, 0xF0F0)"
                title="–ë–µ–ª—ã–π"></div>
              <div
                class="color-option"
                style="background: rgb(255, 255, 0)"
                onclick="setLedColor(1, 0xFFF0)"
                title="–ñ–µ–ª—Ç—ã–π"></div>
            </div>
          </div>

          <div style="margin: 20px 0">
            <h4 style="margin-bottom: 12px">–¶–≤–µ—Ç 2 (–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π)</h4>
            <div class="color-picker">
              <div
                class="color-option"
                style="background: rgb(0, 0, 255)"
                onclick="setLedColor(2, 0xA0F0)"
                title="–°–∏–Ω–∏–π"></div>
              <div
                class="color-option"
                style="background: rgb(0, 255, 0)"
                onclick="setLedColor(2, 0x50F0)"
                title="–ó–µ–ª–µ–Ω—ã–π"></div>
              <div
                class="color-option"
                style="background: rgb(255, 0, 0)"
                onclick="setLedColor(2, 0x00F0)"
                title="–ö—Ä–∞—Å–Ω—ã–π"></div>
              <div
                class="color-option"
                style="background: rgb(255, 0, 255)"
                onclick="setLedColor(2, 0xC8F0)"
                title="–§–∏–æ–ª–µ—Ç–æ–≤—ã–π"></div>
              <div
                class="color-option"
                style="background: rgb(255, 255, 255)"
                onclick="setLedColor(2, 0xF0F0)"
                title="–ë–µ–ª—ã–π"></div>
              <div
                class="color-option"
                style="background: rgb(255, 255, 0)"
                onclick="setLedColor(2, 0xFFF0)"
                title="–ñ–µ–ª—Ç—ã–π"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
      <div id="stats-tab" class="tab-content">
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–µ–∑–¥–æ–∫</h3>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-value" id="singleMileageValue">0</div>
              <div class="stat-label">–ü—Ä–æ–±–µ–≥ –ø–æ–µ–∑–¥–∫–∏ (–∫–º)</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="singleRideTimeValue">0</div>
              <div class="stat-label">–í—Ä–µ–º—è –ø–æ–µ–∑–¥–∫–∏ (–º–∏–Ω)</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="totalOperationTimeValue">0</div>
              <div class="stat-label">–û–±—â–µ–µ –≤—Ä–µ–º—è (—á)</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="totalRideTimeValue">0</div>
              <div class="stat-label">–í—Ä–µ–º—è –¥–≤–∏–∂–µ–Ω–∏—è (—á)</div>
            </div>
          </div>
        </div>

        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üìä –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
          <div style="margin-top: 15px">
            <p>
              <strong>–†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</strong> <span id="workModeValue">N/A</span>
            </p>
            <p>
              <strong>–õ–∏–º–∏—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏:</strong>
              <span id="speedLimitValue">0</span> –∫–º/—á
            </p>
            <p>
              <strong>–ö–æ–¥ –æ—à–∏–±–∫–∏:</strong> <span id="errorCodeValue">0</span>
            </p>
            <p>
              <strong>–ö—Ä—É–∏–∑-–∫–æ–Ω—Ç—Ä–æ–ª—å:</strong>
              <span id="cruiseValue">–í–´–ö–õ</span>
            </p>
            <p><strong>–§–∞—Ä—ã:</strong> <span id="headlightValue">–í–ö–õ</span></p>
            <p><strong>–ó–≤—É–∫:</strong> <span id="beepValue">–í–ö–õ</span></p>
          </div>
        </div>
      </div>

      <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
      <div id="settings-tab" class="tab-content">
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π</h3>
          <div style="margin-top: 20px">
            <div class="setting-row">
              <span class="setting-label">–§–∞—Ä—ã –≤—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω—ã</span>
              <label class="switch">
                <input
                  type="checkbox"
                  id="headlightAlwaysOn"
                  onchange="toggleSetting('headlight_always_on', this.checked)" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-row">
              <span class="setting-label">–°–∫–æ—Ä–æ—Å—Ç—å –≤ MPH (–≤–º–µ—Å—Ç–æ KM/H)</span>
              <label class="switch">
                <input
                  type="checkbox"
                  id="speedInMPH"
                  onchange="toggleSetting('speed_mph', this.checked)" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-row">
              <span class="setting-label"
                >–û—Ç–∫–ª—é—á–∏—Ç—å —Ç—Ä–µ–≤–æ–≥—É –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ</span
              >
              <label class="switch">
                <input
                  type="checkbox"
                  id="noAlarmLock"
                  onchange="toggleSetting('no_alarm_lock', this.checked)" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-row">
              <span class="setting-label">Bluetooth broadcast</span>
              <label class="switch">
                <input
                  type="checkbox"
                  id="btBroadcast"
                  onchange="toggleSetting('bt_broadcast', this.checked)" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-row">
              <span class="setting-label">–ö–Ω–æ–ø–∫–∞ —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏</span>
              <label class="switch">
                <input
                  type="checkbox"
                  id="buttonSpeedMode"
                  checked
                  onchange="toggleSetting('button_speed_mode', this.checked)" />
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üîä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–≤—É–∫–∞ –∏ —Å–≤–µ—Ç–∞</h3>
          <div style="margin-top: 20px">
            <div class="setting-row">
              <span class="setting-label">–ó–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª</span>
              <label class="switch">
                <input
                  type="checkbox"
                  id="beepAlarm"
                  checked
                  onchange="toggleBeepAlarm(this.checked)" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-row">
              <span class="setting-label">–û–±—â–∏–π –∑–≤—É–∫</span>
              <label class="switch">
                <input
                  type="checkbox"
                  id="beepTotal"
                  checked
                  onchange="toggleBeepTotal(this.checked)" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-row">
              <span class="setting-label">–§–∞—Ä—ã</span>
              <label class="switch">
                <input
                  type="checkbox"
                  id="headlight"
                  checked
                  onchange="toggleHeadlight(this.checked)" />
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ -->
      <div id="research-tab" class="tab-content">
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤</h3>
          <p style="margin-bottom: 20px; color: var(--secondary)">
            –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ —Å–∞–º–æ–∫–∞—Ç–∞
          </p>

          <div class="scan-controls">
            <button class="scan-btn safe" onclick="startSafeScan()">
              üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (—á—Ç–µ–Ω–∏–µ)
            </button>
            <button class="scan-btn warning" onclick="startBruteForceScan()">
              ‚ö†Ô∏è –ë—Ä—É—Ç—Ñ–æ—Ä—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–∞–ø–∏—Å—å)
            </button>
            <button class="scan-btn danger" onclick="startDeepScan()">
              üö® –ì–ª—É–±–æ–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
            </button>
          </div>

          <div class="scan-progress">
            <div
              class="scan-progress-bar"
              id="scanProgress"
              style="width: 0%"></div>
          </div>

          <div style="text-align: center; margin: 10px 0">
            <span id="scanStatus">–ì–æ—Ç–æ–≤ –∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é</span>
            <span id="scanProgressText">0/256</span>
          </div>

          <div
            style="
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 8px;
              margin-top: 20px;
            ">
            <input
              type="text"
              id="manualIndex"
              placeholder="–ò–Ω–¥–µ–∫—Å (hex)"
              style="
                padding: 12px;
                border: 1px solid var(--gray);
                border-radius: 8px;
                font-family: monospace;
                width: 100%;
                grid-column: 1;
              " />
            <input
              type="text"
              id="manualValue"
              placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ (hex)"
              style="
                padding: 12px;
                border: 1px solid var(--gray);
                border-radius: 8px;
                font-family: monospace;
                width: 100%;
                grid-column: 2;
              " />
            <button
              class="btn btn-primary"
              onclick="manualTest()"
              style="padding: 12px 16px; width: 100%; grid-column: 1 / span 2">
              –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
            </button>
          </div>
        </div>

        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üéØ –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã</h3>
          <div id="foundRegisters" style="max-height: 300px; overflow-y: auto">
            <p
              style="
                color: var(--secondary);
                text-align: center;
                padding: 20px;
              ">
              –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
            </p>
          </div>
        </div>

        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üìã –õ–æ–≥ –ø–∞–∫–µ—Ç–æ–≤</h3>
          <div style="margin-bottom: 15px; display: flex; gap: 8px">
            <button
              class="btn btn-primary"
              onclick="startPacketLog()"
              style="flex: 1">
              –ù–∞—á–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
            </button>
            <button
              class="btn btn-danger"
              onclick="stopPacketLog()"
              style="flex: 1">
              –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
            </button>
            <button
              class="btn"
              onclick="clearPacketLog()"
              style="flex: 1; background: var(--secondary); color: white">
              –û—á–∏—Å—Ç–∏—Ç—å
            </button>
          </div>
          <div
            id="packetLog"
            style="
              max-height: 200px;
              overflow-y: auto;
              background: var(--gray);
              padding: 10px;
              border-radius: 5px;
              font-family: monospace;
              font-size: 0.8rem;
            "></div>
        </div>

        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üìã –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ/–ò—Å—Å–ª–µ–¥—É–µ–º—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã</h3>
          <p style="margin-bottom: 15px; color: var(--secondary); font-size: 0.9rem;">
            –ó–Ω–∞—á–µ–Ω–∏—è —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞. –§–æ—Ä–º–∞—Ç: HEX (DECIMAL)
          </p>
          <div class="unknown-registers">
            <div class="register-item">
              <div class="register-label">0x00:</div>
              <div class="register-value" id="UnkReg1">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x01:</div>
              <div class="register-value" id="UnkReg2">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x2C (–ö–∞–∫ 56):</div>
              <div class="register-value" id="UnkReg8">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x4C (–Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è):</div>
              <div class="register-value" id="UnkReg15">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x51 (–ö—É—Ä–æ–∫ –≥–∞–∑–∞):</div>
              <div class="register-value" id="UnkReg18">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x52 (–¢–æ—Ä–º–æ–∑):</div>
              <div class="register-value" id="UnkReg19">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x54 (–ö–∞–∫ 56):</div>
              <div class="register-value" id="UnkReg20">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x56 (–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è 1-5):</div>
              <div class="register-value" id="UnkReg21">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x57 (–Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è):</div>
              <div class="register-value" id="UnkReg22">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x66 (–Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è):</div>
              <div class="register-value" id="UnkReg26">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x7F (–æ—à–∏–±–∫–∞ 32):</div>
              <div class="register-value" id="UnkReg28">N/A</div>
            </div>
            <div class="register-item">
              <div class="register-label">0x80 (–§–∞—Ä–∞: 0-–í—ã–∫–ª, 1-–í–∫–ª, 2-–°—Ç—Ä–æ–±):</div>
              <div class="register-value" id="UnkReg30">N/A</div>
            </div>
          </div>
        </div>
      </div>

      <!-- –°–∏—Å—Ç–µ–º–∞ -->
      <div id="system-tab" class="tab-content">
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üõ†Ô∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã</h3>
          <div class="grid-3" style="margin-top: 20px">
            <button
              class="btn btn-warning"
              onclick="sendCommand('find_scooter')">
              <span>üîç</span> –ù–∞–π—Ç–∏ —Å–∞–º–æ–∫–∞—Ç
            </button>
            <button class="btn btn-info" onclick="sendCommand('reboot')">
              <span>üîÑ</span> –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
            </button>
            <button class="btn btn-danger" onclick="sendCommand('power_off')">
              <span>‚≠ï</span> –í—ã–∫–ª—é—á–∏—Ç—å
            </button>
          </div>
        </div>

        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üíª –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
          <div style="margin-top: 15px">
            <p>
              <strong>–¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º –ø–æ–¥—Å–≤–µ—Ç–∫–∏:</strong>
              <span id="currentLedMode">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span>
            </p>
            <p>
              <strong>–í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞:</strong>
              <span id="fwVersion">N/A</span>
            </p>
            <p>
              <strong>–†–∞–±–æ—á–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> <span id="workSystem">1</span>
            </p>
            <p>
              <strong>–°—Ç–∞—Ç—É—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:</strong>
              <span id="lockStatus">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>
            </p>
            <p>
              <strong>–°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∏–≥–∞—Ç–µ–ª—è:</strong>
              <span id="engineStatus">–í–ö–õ</span>
            </p>
          </div>
        </div>

        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h3>
          <div style="margin-top: 15px">
            <p>
              <strong>–ö–æ–¥ –æ—à–∏–±–∫–∏:</strong> <span id="diagnosticError">0</span>
            </p>
            <p>
              <strong>–ö–æ–¥ —Ç—Ä–µ–≤–æ–≥–∏:</strong> <span id="diagnosticAlarm">0</span>
            </p>
            <p>
              <strong>–ë—É–ª–µ–≤—ã —Å—Ç–∞—Ç—É—Å—ã:</strong>
              <span id="diagnosticBool">0x0000</span>
            </p>
            <p>
              <strong>–ë—ã—Å—Ç—Ä—ã–µ —Å—Ç–∞—Ç—É—Å—ã:</strong>
              <span id="diagnosticQuickBool">0x0000</span>
            </p>
            <button
              class="btn btn-primary"
              onclick="loadDiagnostics()"
              style="margin-top: 10px; width: 100%">
              –û–±–Ω–æ–≤–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
            </button>
          </div>
        </div>
      </div>

      <!-- OTA –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ -->
      <div id="ota-tab" class="tab-content">
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–∏—Å—Ç–µ–º–µ -->
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üíª –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ</h3>
          
          <div id="systemInfo" class="ota-info-grid" style="margin: 20px 0;">
            <div class="ota-info-item">
              <div class="label">–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è</div>
              <div class="value" id="currentVersion">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="ota-info-item">
              <div class="label">ID —á–∏–ø–∞</div>
              <div class="value" id="chipId">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="ota-info-item">
              <div class="label">–°–≤–æ–±–æ–¥–Ω–∞—è –ø–∞–º—è—Ç—å</div>
              <div class="value" id="freeMemory">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="ota-info-item">
              <div class="label">–†–∞–∑–º–µ—Ä –ø—Ä–æ—à–∏–≤–∫–∏</div>
              <div class="value" id="sketchSize">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="ota-info-item">
              <div class="label">–†–∞–∑–º–µ—Ä —Ñ–ª–µ—à –ø–∞–º—è—Ç–∏</div>
              <div class="value" id="flashSize">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="ota-info-item">
              <div class="label">ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</div>
              <div class="value" id="deviceId">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="ota-info-item">
              <div class="label">–í–µ—Ä—Å–∏—è SDK</div>
              <div class="value" id="sdkVersion">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
            <div class="ota-info-item">
              <div class="label">–°—á–µ—Ç—á–∏–∫ —Ü–∏–∫–ª–æ–≤</div>
              <div class="value" id="cycleCount">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>
          </div>

          <div class="grid-2" style="gap: 10px; margin-top: 15px">
            <button
              class="btn btn-primary"
              onclick="checkFirmwareInfo()"
              style="width: 100%">
              üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            </button>
            <button
              class="btn btn-secondary"
              onclick="testOTAConnection()"
              style="width: 100%">
              üîó –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
            </button>
          </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π -->
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üöÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</h3>
          
          <div style="margin: 20px 0;">
            <div class="ota-status-display">
              <div class="status-item">
                <span class="status-label">–°—Ç–∞—Ç—É—Å:</span>
                <span class="status-value" id="updateStatus">–ì–æ—Ç–æ–≤ –∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é</span>
              </div>
              <div class="status-item">
                <span class="status-label">–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:</span>
                <span class="status-value" id="lastUpdate">–ù–∏–∫–æ–≥–¥–∞</span>
              </div>
            </div>
          </div>

          <div class="grid-2" style="gap: 10px; margin-bottom: 15px">
            <button
              id="checkUpdateBtn"
              class="btn btn-success"
              onclick="checkForUpdates(CURRENT_VERSION, REPO_OWNER, REPO_NAME, true)"
              style="width: 100%">
              üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            </button>
            <button
              id="showInstructionsBtn"
              class="btn btn-info"
              onclick="showOTAInstructions()"
              style="width: 100%">
              üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
            </button>
          </div>

          <div id="updateNotification" style="display: none; margin-top: 15px;">
            <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å -->
          </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ OTA –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ -->
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">üì§ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π OTA –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</h3>
          
          <div style="margin: 20px 0;">
            <p style="margin-bottom: 15px">
              –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ESP8266 –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏:
            </p>
            
            <div style="background: var(--gray); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
              <p style="margin-bottom: 8px"><strong>–õ–æ–≥–∏–Ω:</strong> admin</p>
              <p><strong>–ü–∞—Ä–æ–ª—å:</strong> NinebotOTA123!</p>
            </div>
          </div>

          <div class="grid-2" style="gap: 10px">
            <a
              href="/update"
              target="_blank"
              class="btn btn-primary"
              style="text-decoration: none; width: 100%">
              üì§ –û—Ç–∫—Ä—ã—Ç—å OTA
            </a>
            <button
              class="btn btn-secondary"
              onclick="window.open('/update', '_blank')"
              style="width: 100%">
              üåê –í –Ω–æ–≤–æ–º –æ–∫–Ω–µ
            </button>
          </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ —Ä—É—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div class="card animate-slide">
          <h3 style="margin-bottom: 16px">‚ö° –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</h3>
          
          <div style="margin: 20px 0;">
            <p style="margin-bottom: 15px">
              –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –ø—Ä–æ—à–∏–≤–∫–∏ (.bin) –Ω–∞–ø—Ä—è–º—É—é:
            </p>
            
            <div class="upload-area" id="uploadArea" style="
              border: 2px dashed var(--gray);
              border-radius: 8px;
              padding: 30px;
              text-align: center;
              cursor: pointer;
              margin-bottom: 15px;
              transition: all 0.3s ease;
            ">
              <div style="font-size: 48px; margin-bottom: 10px;">üìÅ</div>
              <p style="margin-bottom: 5px; font-weight: bold;">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞</p>
              <p style="font-size: 0.9rem; color: var(--secondary);">
                –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª .bin —Å—é–¥–∞
              </p>
              <input
                type="file"
                id="firmwareFile"
                accept=".bin"
                style="display: none;"
                onchange="handleFirmwareUpload(event)">
            </div>
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div id="uploadProgressContainer" style="display: none; margin: 15px 0;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                <span>–ó–∞–≥—Ä—É–∑–∫–∞:</span>
                <span id="uploadProgressText">0%</span>
              </div>
              <div style="
                width: 100%;
                height: 8px;
                background: var(--gray);
                border-radius: 4px;
                overflow: hidden;
              ">
                <div id="uploadProgress" style="
                  width: 0%;
                  height: 100%;
                  background: linear-gradient(90deg, var(--primary), var(--accent));
                  transition: width 0.3s ease;
                "></div>
              </div>
            </div>
          </div>

          <div class="grid-2" style="gap: 10px">
            <button
              id="uploadFirmwareBtn"
              class="btn btn-warning"
              onclick="document.getElementById('firmwareFile').click()"
              style="width: 100%">
              üìÅ –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
            </button>
            <button
              id="manualUpdateBtn"
              class="btn btn-success"
              onclick="startManualUpdate()"
              disabled
              style="width: 100%">
              üöÄ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            </button>
          </div>
          
          <!-- –§–æ—Ä–º–∞ –¥–ª—è fallback -->
          <form
            id="otaForm"
            action="/update"
            method="POST"
            enctype="multipart/form-data"
            target="_blank"
            style="display: none;">
            <input type="file" name="update" id="fallbackFileInput" accept=".bin">
          </form>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è -->
        <div class="card animate-slide" id="autoUpdateCard" style="display: none;">
          <h3 style="margin-bottom: 16px">üéØ –î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ!</h3>
          
          <div style="margin: 20px 0;">
            <div class="update-info" style="
              background: linear-gradient(135deg, var(--warning-light), var(--warning));
              color: white;
              padding: 15px;
              border-radius: 8px;
              margin-bottom: 15px;
            ">
              <div style="display: flex; align-items: center; margin-bottom: 10px;">
                <span style="font-size: 24px; margin-right: 10px;">üéØ</span>
                <div>
                  <p style="margin: 0; font-weight: bold; font-size: 1.1rem;">–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞!</p>
                  <p style="margin: 0; font-size: 0.9rem;" id="newVersionText">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                </div>
              </div>
            </div>
            
            <div style="margin-bottom: 15px;">
              <p><strong>–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:</strong> <span id="currentVersionDisplay">v0.0.0</span></p>
              <p><strong>–ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è:</strong> <span id="latestVersionDisplay">v0.0.0</span></p>
            </div>
            
            <div id="releaseNotes" style="
              max-height: 150px;
              overflow-y: auto;
              padding: 10px;
              background: var(--gray);
              border-radius: 6px;
              font-size: 0.9rem;
              margin-bottom: 15px;
            ">
              <!-- –ó–∞–º–µ—Ç–∫–∏ –æ —Ä–µ–ª–∏–∑–µ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å -->
            </div>
          </div>

          <button
            id="startAutoUpdateBtn"
            class="btn btn-danger"
            style="width: 100%"
            onclick="startManualUpdate()">
            ‚ö° –ù–∞—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
          </button>
        </div>
      </div>
    </div>

    <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="mobile-nav">
      <button class="mobile-nav-item active" onclick="switchTab('dashboard')">
        <span class="mobile-nav-icon">üìä</span>
        <span>–ì–ª–∞–≤–Ω–∞—è</span>
      </button>
      <button class="mobile-nav-item" onclick="switchTab('lights')">
        <span class="mobile-nav-icon">üåà</span>
        <span>–°–≤–µ—Ç</span>
      </button>
      <button class="mobile-nav-item" onclick="switchTab('stats')">
        <span class="mobile-nav-icon">üìà</span>
        <span>–°—Ç–∞—Ç—ã</span>
      </button>
      <button class="mobile-nav-item" onclick="showActionSheet('more')">
        <span class="mobile-nav-icon">‚ãØ</span>
        <span>–ï—â–µ</span>
      </button>
    </div>

    <!-- –í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –º–µ–Ω—é -->
    <div class="action-sheet" id="actionSheet">
      <div class="action-sheet-title" id="actionSheetTitle">–î–µ–π—Å—Ç–≤–∏—è</div>
      <div id="actionSheetContent">
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
      </div>
      <button class="action-sheet-cancel" onclick="hideActionSheet()">
        –û—Ç–º–µ–Ω–∞
      </button>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification" id="notification">
      <div class="notification-icon">‚úÖ</div>
      <div id="notificationText">–ì–æ—Ç–æ–≤–æ</div>
    </div>
    <script src="script.js"></script>
  </body>
</html>
